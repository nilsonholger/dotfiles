# settings
autoload -Uz compinit
compinit
autoload -U colors
colors

HISTFILE=~/.histfile
HISTSIZE=32676
SAVEHIST=32676
setopt extendedhistory
setopt histignorealldups
setopt histignorespace
setopt histnostore
setopt histreduceblanks
setopt histsavenodups
setopt histverify
setopt incappendhistory
setopt sharehistory

setopt autopushd
setopt extendedglob
setopt pushdignoredups

setopt brace_ccl
setopt correct_all
setopt nobgnice
setopt notify
setopt prompt_subst
unsetopt beep

bindkey -v
bindkey '^r' history-incremental-pattern-search-backward
bindkey '^f' history-incremental-pattern-search-forward
PERIOD=60

bindkey -M viins "$terminfo[cuu1]" up-line-or-history
bindkey -M viins "$terminfo[kcuu1]" up-line-or-history
bindkey -M viins "$terminfo[kcud1]" down-line-or-history

zstyle :compinstall filename '~/.zshrc'
zstyle ':completion:*' group-name ''
zstyle ':completion:*' menu select
zstyle ':completion:*' special-dirs true
zstyle ':completion:*' format "%U%F{green}[%d]%u%b%f"
zstyle ':completion:*:descriptions' format $'%{\e[0;31m%}completing %B%d%b%{\e[0m%}'
zstyle ':completion:*:messages' format "%B%U%F{red}%d%u%b%f"
zstyle ':completion:*:warnings' format "%F{red}[%d]%f"

alias dud='du -hd1 | sort -hr'
alias dvorak='setxkbmap -model pc104 -layout us,us,de -variant dvp,,nodeadkeys -option lv3:ralt_switch'
hash krenew 2> /dev/null && alias ktmux='krenew -biL -- /usr/bin/zsh -c "tmux new -d && while tmux ls &>/dev/null; do sleep 60; done"; sleep 1; tmux a'
ls --color &> /dev/null && alias ls='ls --color'
alias scpr='rsync --partial --progress --rsh=ssh'

[ -f ~/.org/index.wiki ] && alias org='wiki ~/.org'
[ -f ~/cvhci/res/index.wiki ] && alias res='wiki ~/cvhci/res'

export CLICOLOR="yes"
export EDITOR="vim"
export GPG_TTY=$(tty) # announce tty to pinentry
export LESS_TERMCAP_mb=$'\E[01;31m'    # mode blink
export LESS_TERMCAP_md=$'\E[01;31m'    # mode bold
export LESS_TERMCAP_me=$'\E[0m'        # end mode
export LESS_TERMCAP_se=$'\E[0m'        # stand-out end
export LESS_TERMCAP_so=$'\E[01;44;33m' # stand-out
export LESS_TERMCAP_ue=$'\E[0m'        # end underline
export LESS_TERMCAP_us=$'\E[01;32m'    # begin underline
export LSCOLORS=cxfxexdxCxegedabagacad # directory: green, sockets: blue, executable: bold green
export LS_COLORS='di=32'
export MAKEFLAGS="-j`sysctl -n hw.ncpu 2> /dev/null || grep -c '^processor' /proc/cpuinfo`"
export XLIB_SKIP_ARGB_VISUALS=1

export PATH="/usr/local/sbin:${PATH/:\/usr\/local\/sbin}"
export PATH="/usr/local/bin:${PATH/:\/usr\/local\/bin}"
[ -d /usr/texbin ] || export PATH="$PATH:/usr/texbin"
export PATH="$PATH:$HOME/.bin"

if [ -d $HOME/local ]
then
	PATH="$HOME/local/bin:$PATH"
	local _LIBS="$HOME/local/lib64:$HOME/local/lib32:$HOME/local/lib"

	[ -d $HOME/local/cuda ] && export PATH="$PATH:$HOME/local/cuda/bin"
	[ -d $HOME/local/cuda ] && _LIBS="$_LIBS:$HOME/local/cuda/lib64:$HOME/local/cuda/lib"
	[ -d /usr/lib/x86_64-linux-gnu ] && _LIBS="$_LIBS:/usr/lib/x86_64-linux-gnu"

	export LIBRARY_PATH="$_LIBS"
	export LD_LIBRARY_PATH="$_LIBS"
	export LD_RUN_PATH="$_LIBS"
	export C_INCLUDE_PATH="$HOME/local/include:/usr/include/x86_64-linux-gnu"
	export CPLUS_INCLUDE_PATH="$HOME/local/include:/usr/include/x86_64-linux-gnu"
	export PKG_CONFIG_PATH="$HOME/local/lib/pkgconfig"
	[ -d $HOME/local/libexec/git-core/ ] && export GIT_EXEC_PATH="$HOME/local/libexec/git-core"
fi

[ -d $HOME/android ] && export PATH="$PATH:$HOME/android/tools:$HOME/android/platform-tools:$HOME/android/ndk"

ulimit -c unlimited
umask 077
